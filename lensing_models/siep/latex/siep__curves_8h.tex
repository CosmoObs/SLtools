\hypertarget{siep__curves_8h}{
\section{siep\_\-curves.h File Reference}
\label{siep__curves_8h}\index{siep\_\-curves.h@{siep\_\-curves.h}}
}
{\ttfamily \#include $<$math.h$>$}\par
{\ttfamily \#include \char`\"{}siep\_\-lens\_\-funct.h\char`\"{}}\par
\subsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
namespace \hyperlink{namespacesiep__model}{siep\_\-model}
\end{DoxyCompactItemize}
\subsection*{Defines}
\begin{DoxyCompactItemize}
\item 
\hypertarget{siep__curves_8h_a598a3330b3c21701223ee0ca14316eca}{
\#define {\bfseries PI}~3.1415926535897932384626433832795}
\label{siep__curves_8h_a598a3330b3c21701223ee0ca14316eca}

\item 
\hypertarget{siep__curves_8h_ac0cf2902c27019004022f788b44d0f5e}{
\#define {\bfseries TAM\_\-MAX}~2000}
\label{siep__curves_8h_ac0cf2902c27019004022f788b44d0f5e}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{siep__curves_8h_aa79848608dfc953b540938a39c4def10}{r\_\-cct\_\-siep} (double theta, double siep\_\-params\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{siep__curves_8h_adb35e2654637d89bc9ba30a21fd959d0}{r\_\-th\_\-siep} (double theta, double siep\_\-params\mbox{[}$\,$\mbox{]}, double rth)
\item 
double \hyperlink{siep__curves_8h_ade539e48ff3f732df64e64bfcc216373}{r\_\-ccr\_\-siep} (double theta, double siep\_\-params\mbox{[}$\,$\mbox{]})
\item 
void \hyperlink{siep__curves_8h_a4cac1f8fd8413fddfa9418fa4a739891}{cc\_\-tan\_\-siep} (double siep\_\-params\mbox{[}$\,$\mbox{]}, double xtcc\mbox{[}$\,$\mbox{]}, double ytcc\mbox{[}$\,$\mbox{]}, int npts=1000, FILE $\ast$file\_\-in1=NULL)
\item 
void \hyperlink{siep__curves_8h_a015abea7a25a6a6bb5ba34b9733f6231}{cc\_\-lw\_\-pos\_\-siep} (double siep\_\-params\mbox{[}$\,$\mbox{]}, double lw\_\-th, double xlwp\mbox{[}$\,$\mbox{]}, double ylwp\mbox{[}$\,$\mbox{]}, int npts=1000, FILE $\ast$file\_\-in1=NULL)
\item 
void \hyperlink{siep__curves_8h_abb975e8f3f17a3a66378d5c5cc3fb33b}{cc\_\-lw\_\-neg\_\-siep} (double siep\_\-params\mbox{[}$\,$\mbox{]}, double lw\_\-th, double xlwn\mbox{[}$\,$\mbox{]}, double ylwn\mbox{[}$\,$\mbox{]}, int npts=1000, FILE $\ast$file\_\-in1=NULL)
\item 
void \hyperlink{siep__curves_8h_ab6f9bf17f6a43ce12a3850c5f7fcb11c}{cc\_\-rad\_\-siep} (double siep\_\-params\mbox{[}$\,$\mbox{]}, double xrad\mbox{[}$\,$\mbox{]}, double yrad\mbox{[}$\,$\mbox{]}, int npts=1000, FILE $\ast$file\_\-in1=NULL)
\item 
double \hyperlink{siep__curves_8h_a0293cd717123de4fa537fb592dcda9d9}{cross\_\-section\_\-siep} (double siep\_\-params\mbox{[}$\,$\mbox{]}, double r\_\-th)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
In this file, we find the functions that are useful to compute:

Tangential and Radial Critical Curves

Tangential and Radial Caustics

Curves of constant distortion in both planes.

Cross section for deformation arcs (Analytical Expression)

Notice: This model have 3 main parameters.

siep\_\-params\mbox{[}0\mbox{]}: Integer useful to choose the flag for the parameterization for the ellipticity

If siep\_\-params\mbox{[}0\mbox{]}=1 : $ a_{1\varepsilon}=1-\varepsilon $ and $ a_{2\varepsilon}=1+\varepsilon $ (Angle Deflection Model)

If siep\_\-params\mbox{[}0\mbox{]}=2 : $ a_{1\varepsilon}=1-\varepsilon $ and $ a_{2\varepsilon}=\frac{1}{1-\varepsilon} $ (Standard parametrization)

If siep\_\-params\mbox{[}0\mbox{]}=3 : $ a_{1\varepsilon}=1 $ and $ a_{2\varepsilon}=\frac{1}{(1-\varepsilon)^2} $ (Keeton's Parametrization)

siep\_\-params\mbox{[}1\mbox{]}: Ellipticity value (must be ellipticity parameter or ellipticity by itself whether the angle deflection model is used)

siep\_\-params\mbox{[}2\mbox{]}: Mass of the SIS model, related wit the velocity dispersion. 

\subsection{Function Documentation}
\hypertarget{siep__curves_8h_abb975e8f3f17a3a66378d5c5cc3fb33b}{
\index{siep\_\-curves.h@{siep\_\-curves.h}!cc\_\-lw\_\-neg\_\-siep@{cc\_\-lw\_\-neg\_\-siep}}
\index{cc\_\-lw\_\-neg\_\-siep@{cc\_\-lw\_\-neg\_\-siep}!siep_curves.h@{siep\_\-curves.h}}
\subsubsection[{cc\_\-lw\_\-neg\_\-siep}]{\setlength{\rightskip}{0pt plus 5cm}void cc\_\-lw\_\-neg\_\-siep (double {\em siep\_\-params}\mbox{[}$\,$\mbox{]}, \/  double {\em lw\_\-th}, \/  double {\em xlwn}\mbox{[}$\,$\mbox{]}, \/  double {\em ylwn}\mbox{[}$\,$\mbox{]}, \/  int {\em npts} = {\ttfamily 1000}, \/  FILE $\ast$ {\em file\_\-in1} = {\ttfamily NULL})}}
\label{siep__curves_8h_abb975e8f3f17a3a66378d5c5cc3fb33b}
A functions to print the constant distortion curve for $ R_{\rm th}<0 $ for the SIEP

In the lens plane this function plot the following parametric equation:

$ x_{1,lwn}=\dfrac{x_{\varepsilon,R_{\rm th}}\cos{\phi_\varepsilon}}{\sqrt{a_{1\varepsilon}}}$

$ x_{2,lwn}=\dfrac{x_{\varepsilon,R_{\rm th}}\sin{\phi_\varepsilon}}{\sqrt{a_{2\varepsilon}}}$

In the source plane, this function plot the following parametric equation:

$ y_{1,lwn} =x_{1,lwn}-\sqrt{a_{1\varepsilon}}\cos{\phi_\varepsilon}$

$ y_{2,lwn} =x_{2,lwn}-\sqrt{a_{2\varepsilon}}\sin{\phi_\varepsilon} $


\begin{DoxyParams}{Parameters}
\item[{\em siep\_\-params\mbox{[}$\,$\mbox{]}}]: SIEP parameters \item[{\em xlwn\mbox{[}$\,$\mbox{]}}]: Vector containing the first coordinate of the constant distortion curve in the lens plane for $ R_{\rm th}<0 $ \item[{\em ylwn\mbox{[}$\,$\mbox{]}}]: Vector containing the second coordinate of the constant distortion curve in the lens plane for $ R_{\rm th}<0 $ \item[{\em npts}]: number of point to divide the range in values of theta, by default=1000 \end{DoxyParams}
\begin{DoxyReturn}{Returns}
by default the vector (xlwn,ylwn) or if it is indicated a data file containing such vector 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{siep__curves_8h_adb35e2654637d89bc9ba30a21fd959d0}{r\_\-th\_\-siep} 
\end{DoxySeeAlso}
\hypertarget{siep__curves_8h_a015abea7a25a6a6bb5ba34b9733f6231}{
\index{siep\_\-curves.h@{siep\_\-curves.h}!cc\_\-lw\_\-pos\_\-siep@{cc\_\-lw\_\-pos\_\-siep}}
\index{cc\_\-lw\_\-pos\_\-siep@{cc\_\-lw\_\-pos\_\-siep}!siep_curves.h@{siep\_\-curves.h}}
\subsubsection[{cc\_\-lw\_\-pos\_\-siep}]{\setlength{\rightskip}{0pt plus 5cm}void cc\_\-lw\_\-pos\_\-siep (double {\em siep\_\-params}\mbox{[}$\,$\mbox{]}, \/  double {\em lw\_\-th}, \/  double {\em xlwp}\mbox{[}$\,$\mbox{]}, \/  double {\em ylwp}\mbox{[}$\,$\mbox{]}, \/  int {\em npts} = {\ttfamily 1000}, \/  FILE $\ast$ {\em file\_\-in1} = {\ttfamily NULL})}}
\label{siep__curves_8h_a015abea7a25a6a6bb5ba34b9733f6231}
A functions to print the constant distortion curve for $ R_{\rm th}>0 $ for the SIEP

In the lens plane this function plot the following parametric equation:

$ x_{1,lwp}=\dfrac{x_{\varepsilon,R_{\rm th}}\cos{\phi_\varepsilon}}{\sqrt{a_{1\varepsilon}}}$

$ x_{2,lwp}=\dfrac{x_{\varepsilon,R_{\rm th}}\sin{\phi_\varepsilon}}{\sqrt{a_{2\varepsilon}}}$

In the source plane, this function plot the following parametric equation:

$ y_{1,lwp} =x_{1,lwp}-\sqrt{a_{1\varepsilon}}\cos{\phi_\varepsilon}$

$ y_{2,lwp} =x_{2,lwp}-\sqrt{a_{2\varepsilon}}\sin{\phi_\varepsilon} $


\begin{DoxyParams}{Parameters}
\item[{\em siep\_\-params\mbox{[}$\,$\mbox{]}}]: SIEP parameters \item[{\em xlwp\mbox{[}$\,$\mbox{]}}]: Vector containing the first coordinate of the constant distortion curve in the lens plane for $ R_{\rm th}>0 $ \item[{\em ylwp\mbox{[}$\,$\mbox{]}}]: Vector containing the second coordinate of the constant distortion curve in the lens plane for $ R_{\rm th}>0 $ \item[{\em npts}]: number of point to divide the range in values of theta, by default=1000 \end{DoxyParams}
\begin{DoxyReturn}{Returns}
by default the vector (xlwp,ylwp) or if it is indicated a data file containing such vector 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{siep__curves_8h_adb35e2654637d89bc9ba30a21fd959d0}{r\_\-th\_\-siep} 
\end{DoxySeeAlso}
\hypertarget{siep__curves_8h_ab6f9bf17f6a43ce12a3850c5f7fcb11c}{
\index{siep\_\-curves.h@{siep\_\-curves.h}!cc\_\-rad\_\-siep@{cc\_\-rad\_\-siep}}
\index{cc\_\-rad\_\-siep@{cc\_\-rad\_\-siep}!siep_curves.h@{siep\_\-curves.h}}
\subsubsection[{cc\_\-rad\_\-siep}]{\setlength{\rightskip}{0pt plus 5cm}void cc\_\-rad\_\-siep (double {\em siep\_\-params}\mbox{[}$\,$\mbox{]}, \/  double {\em xrad}\mbox{[}$\,$\mbox{]}, \/  double {\em yrad}\mbox{[}$\,$\mbox{]}, \/  int {\em npts} = {\ttfamily 1000}, \/  FILE $\ast$ {\em file\_\-in1} = {\ttfamily NULL})}}
\label{siep__curves_8h_ab6f9bf17f6a43ce12a3850c5f7fcb11c}
A functions to print the radial curves ( critical and caustic) for the SIEP

For the radial critical curve, this function plot the following parametric equation:

$ x_{1,rcc}=0$

$ x_{2,rcc}=0$

For the radial caustic, this function plot the following parametric equation:

$ y_{1,rca} =-\sqrt{a_{1\varepsilon}}\cos{\phi_\varepsilon}$

$ y_{2,rca} =-\sqrt{a_{2\varepsilon}}\sin{\phi_\varepsilon} $


\begin{DoxyParams}{Parameters}
\item[{\em siep\_\-params\mbox{[}$\,$\mbox{]}}]: SIEP parameters \item[{\em xrad\mbox{[}$\,$\mbox{]}}]: Vector containing the first coordinate of the radial critical curve \item[{\em yrad\mbox{[}$\,$\mbox{]}}]: Vector containing the second coordinate of the radial critical curve \item[{\em npts}]: number of point to divide the range in values of theta, by default=1000 \end{DoxyParams}
\begin{DoxyReturn}{Returns}
by default the vector (xrad,yrad) or if it is indicated a data file containing such vector 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{siep__curves_8h_ade539e48ff3f732df64e64bfcc216373}{r\_\-ccr\_\-siep} 
\end{DoxySeeAlso}
\hypertarget{siep__curves_8h_a4cac1f8fd8413fddfa9418fa4a739891}{
\index{siep\_\-curves.h@{siep\_\-curves.h}!cc\_\-tan\_\-siep@{cc\_\-tan\_\-siep}}
\index{cc\_\-tan\_\-siep@{cc\_\-tan\_\-siep}!siep_curves.h@{siep\_\-curves.h}}
\subsubsection[{cc\_\-tan\_\-siep}]{\setlength{\rightskip}{0pt plus 5cm}void cc\_\-tan\_\-siep (double {\em siep\_\-params}\mbox{[}$\,$\mbox{]}, \/  double {\em xtcc}\mbox{[}$\,$\mbox{]}, \/  double {\em ytcc}\mbox{[}$\,$\mbox{]}, \/  int {\em npts} = {\ttfamily 1000}, \/  FILE $\ast$ {\em file\_\-in1} = {\ttfamily NULL})}}
\label{siep__curves_8h_a4cac1f8fd8413fddfa9418fa4a739891}
A functions to print the tangential curves ( critical and caustic) for the SIEP

For the tangential critical curve, this function plot the following parametric equation:

$ x_{1,tcc}=\dfrac{x_{\varepsilon,tcc}\cos{\phi_\varepsilon}}{\sqrt{a_{1\varepsilon}}}$

$ x_{2,tcc}=\dfrac{x_{\varepsilon,tcc}\sin{\phi_\varepsilon}}{\sqrt{a_{2\varepsilon}}}$

For the tangential caustic, this function plot the following parametric equation:

$ y_{1,tca} =x_{1,tcc}-\sqrt{a_{1\varepsilon}}\cos{\phi_\varepsilon}$

$ y_{2,tca} =x_{2,tcc}-\sqrt{a_{2\varepsilon}}\sin{\phi_\varepsilon} $


\begin{DoxyParams}{Parameters}
\item[{\em siep\_\-params\mbox{[}$\,$\mbox{]}}]: SIEP parameters \item[{\em xtcc\mbox{[}$\,$\mbox{]}}]: Vector containing the first coordinate of the tangential critical curve \item[{\em ytcc\mbox{[}$\,$\mbox{]}}]: Vector containing the second coordinate of the tangential critical curve \item[{\em npts}]: number of point to divide the range in values of theta, by default=1000 \end{DoxyParams}
\begin{DoxyReturn}{Returns}
by default the vector (xtcc,ytcc) or if it is indicated a data file containing such vector 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{siep__curves_8h_aa79848608dfc953b540938a39c4def10}{r\_\-cct\_\-siep} 
\end{DoxySeeAlso}
\hypertarget{siep__curves_8h_a0293cd717123de4fa537fb592dcda9d9}{
\index{siep\_\-curves.h@{siep\_\-curves.h}!cross\_\-section\_\-siep@{cross\_\-section\_\-siep}}
\index{cross\_\-section\_\-siep@{cross\_\-section\_\-siep}!siep_curves.h@{siep\_\-curves.h}}
\subsubsection[{cross\_\-section\_\-siep}]{\setlength{\rightskip}{0pt plus 5cm}double cross\_\-section\_\-siep (double {\em siep\_\-params}\mbox{[}$\,$\mbox{]}, \/  double {\em r\_\-th})}}
\label{siep__curves_8h_a0293cd717123de4fa537fb592dcda9d9}
A functions to compute the cross section for arc formation for the SIEP model

$ \sigma_{\rm siep}= R^2_{\rm E}\frac{|R_{\rm th}|^2+1}{(|R_{\rm th}|^2-1)^2}\times \left\{2\pi\left[ [\mathcal{A}(\varepsilon)-\mathcal{B}(\varepsilon)]^2+\frac{2\,a_{1\varepsilon}\mathcal{B}^2(\varepsilon)}{a_{1\varepsilon}+4\,a_{2\varepsilon}\pi^{2}} \right]+ 2[2\mathcal{A}(\varepsilon)\mathcal{B}(\varepsilon)-\mathcal{B}^2(\varepsilon)]\sqrt{\frac{a_{1\varepsilon}}{a_{2\varepsilon}}}\arctan{\left( 2\pi\sqrt{\frac{a_{2\varepsilon}}{a_{1\varepsilon}}}\right)} \right\} $

where $ \mathcal{A}(\varepsilon)=\frac{1}{2} (a_{1\varepsilon}+a_{2\varepsilon})$ and $ \mathcal{B}(\varepsilon)=\frac{1}{2}(a_{1\varepsilon}-a_{2\varepsilon})$


\begin{DoxyParams}{Parameters}
\item[{\em siep\_\-params\mbox{[}$\,$\mbox{]}}]: SIEP parameters \item[{\em r\_\-th,:}]length-\/to-\/width ratio threshold \end{DoxyParams}
\begin{DoxyReturn}{Returns}
$ \sigma_{\rm siep} $ 
\end{DoxyReturn}
\hypertarget{siep__curves_8h_ade539e48ff3f732df64e64bfcc216373}{
\index{siep\_\-curves.h@{siep\_\-curves.h}!r\_\-ccr\_\-siep@{r\_\-ccr\_\-siep}}
\index{r\_\-ccr\_\-siep@{r\_\-ccr\_\-siep}!siep_curves.h@{siep\_\-curves.h}}
\subsubsection[{r\_\-ccr\_\-siep}]{\setlength{\rightskip}{0pt plus 5cm}double r\_\-ccr\_\-siep (double {\em theta}, \/  double {\em siep\_\-params}\mbox{[}$\,$\mbox{]})}}
\label{siep__curves_8h_ade539e48ff3f732df64e64bfcc216373}
Radial Coordinate of the Radial Critical Curve

$ x_{\varepsilon,rcc}=0 $,

\begin{DoxyReturn}{Returns}
$ x_{\varepsilon,rcc}(x)$ 
\end{DoxyReturn}
\hypertarget{siep__curves_8h_aa79848608dfc953b540938a39c4def10}{
\index{siep\_\-curves.h@{siep\_\-curves.h}!r\_\-cct\_\-siep@{r\_\-cct\_\-siep}}
\index{r\_\-cct\_\-siep@{r\_\-cct\_\-siep}!siep_curves.h@{siep\_\-curves.h}}
\subsubsection[{r\_\-cct\_\-siep}]{\setlength{\rightskip}{0pt plus 5cm}double r\_\-cct\_\-siep (double {\em theta}, \/  double {\em siep\_\-params}\mbox{[}$\,$\mbox{]})}}
\label{siep__curves_8h_aa79848608dfc953b540938a39c4def10}
Pseudo-\/Elliptical Radial Coordinate of the Tangential Critical Curve of the SIEP model

$ x_{\varepsilon,tcc}= \mathcal{A}(\varepsilon)-\mathcal{B}(\varepsilon)\cos{2\phi_\varepsilon} $, where $ \mathcal{A}(\varepsilon)$ and $ \mathcal{B}(\varepsilon)$ are already defined in \hyperlink{siep__lens__funct_8h}{siep\_\-lens\_\-funct.h}


\begin{DoxyParams}{Parameters}
\item[{\em theta}]: angular coordinate, and therefore $ \phi_\varepsilon= \arctan{\left(\sqrt{\frac{a_{2\varepsilon}}{a_{1\varepsilon}}}\tan{(\theta)}\right)} $ \item[{\em siep\_\-params\mbox{[}$\,$\mbox{]}}]: parameters of the SIEP model \end{DoxyParams}
\begin{DoxyReturn}{Returns}
$ x_{\varepsilon,tcc}(x)$ 
\end{DoxyReturn}
\hypertarget{siep__curves_8h_adb35e2654637d89bc9ba30a21fd959d0}{
\index{siep\_\-curves.h@{siep\_\-curves.h}!r\_\-th\_\-siep@{r\_\-th\_\-siep}}
\index{r\_\-th\_\-siep@{r\_\-th\_\-siep}!siep_curves.h@{siep\_\-curves.h}}
\subsubsection[{r\_\-th\_\-siep}]{\setlength{\rightskip}{0pt plus 5cm}double r\_\-th\_\-siep (double {\em theta}, \/  double {\em siep\_\-params}\mbox{[}$\,$\mbox{]}, \/  double {\em rth})}}
\label{siep__curves_8h_adb35e2654637d89bc9ba30a21fd959d0}
Pseudo-\/Elliptical Radial Coordinate of the Constant Distortion curve.

$ x_{\varepsilon,R_{\rm th}}=x_{\varepsilon,tcc}\times\left\{\begin{array}{cc} \dfrac{|R_{\rm th}|}{|R_{\rm th}|-1}, & R_{\rm th}>0 \\ & \\ \dfrac{|R_{\rm th}|}{|R_{\rm th}|+1}, & R_{\rm th}<0 \end{array}\right.$,

\begin{DoxyReturn}{Returns}
$ x_{\varepsilon,R_{\rm th}}(x)$ 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{siep__curves_8h_aa79848608dfc953b540938a39c4def10}{r\_\-cct\_\-siep} 
\end{DoxySeeAlso}
