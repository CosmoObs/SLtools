<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>SIEP: siep_curves.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>siep_curves.h</h1><a href="siep__curves_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// File: siep_curves.h</span>
<a name="l00002"></a>00002 <span class="comment">// Author: Habib Dumet-Montoya</span>
<a name="l00003"></a>00003 <span class="comment">// Date: January, 2011</span>
<a name="l00034"></a>00034 <span class="comment"></span><span class="preprocessor">#ifndef SIEP_CURVES_H</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">#define SIEP_CURVES_H</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include "<a class="code" href="siep__lens__funct_8h.html">siep_lens_funct.h</a>"</span> 
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="preprocessor">#define PI 3.1415926535897932384626433832795 </span>
<a name="l00042"></a>00042 <span class="preprocessor"></span><span class="preprocessor">#define TAM_MAX 2000</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span>
<a name="l00048"></a>00048 
<a name="l00055"></a><a class="code" href="siep__curves_8h.html#a79848608dfc953b540938a39c4def10">00055</a> <span class="keywordtype">double</span> <a class="code" href="siep__curves_8h.html#a79848608dfc953b540938a39c4def10">r_cct_siep</a>(<span class="keywordtype">double</span> theta,<span class="keywordtype">double</span> siep_params[]){
<a name="l00056"></a>00056 <span class="keywordtype">int</span> pflag=siep_params[0];
<a name="l00057"></a>00057 <span class="keywordtype">double</span> elp,b,a1e,a2e,theta_e,Ae,Be;
<a name="l00058"></a>00058 elp=siep_params[1];
<a name="l00059"></a>00059 b=siep_params[2];
<a name="l00060"></a>00060 <span class="keywordflow">if</span>(pflag==1){a1e=1.-elp;a2e=1.+elp;}
<a name="l00061"></a>00061 <span class="keywordflow">if</span>(pflag==2){a1e=1.;a2e=pow(1.-elp,-2);}
<a name="l00062"></a>00062 theta_e=atan(sqrt(a2e/a1e)*tan(theta));  
<a name="l00063"></a>00063 Ae=0.5*(a1e+a2e), Be=0.5*(a1e-a2e);
<a name="l00064"></a>00064 <span class="keywordtype">double</span> r_crit=Ae-Be*cos(2.*theta_e);
<a name="l00065"></a>00065 <span class="keywordflow">return</span> r_crit;
<a name="l00066"></a>00066 }
<a name="l00067"></a>00067 
<a name="l00071"></a>00071 \f$, 
<a name="l00077"></a><a class="code" href="siep__curves_8h.html#db35e2654637d89bc9ba30a21fd959d0">00077</a> <span class="keywordtype">double</span> <a class="code" href="siep__curves_8h.html#db35e2654637d89bc9ba30a21fd959d0">r_th_siep</a>(<span class="keywordtype">double</span> theta, <span class="keywordtype">double</span> siep_params[], <span class="keywordtype">double</span> rth){
<a name="l00078"></a>00078 <span class="keywordtype">double</span> qth=1.-1/rth;
<a name="l00079"></a>00079 <span class="keywordtype">double</span> r_th_c=<a class="code" href="siep__curves_8h.html#a79848608dfc953b540938a39c4def10">r_cct_siep</a>(theta,siep_params)*(1./qth);
<a name="l00080"></a>00080 <span class="keywordflow">return</span> r_th_c;
<a name="l00081"></a>00081 }
<a name="l00082"></a>00082 
<a name="l00086"></a>00086 
<a name="l00090"></a><a class="code" href="siep__curves_8h.html#de539e48ff3f732df64e64bfcc216373">00090</a> <span class="keywordtype">double</span> <a class="code" href="siep__curves_8h.html#de539e48ff3f732df64e64bfcc216373">r_ccr_siep</a>(<span class="keywordtype">double</span> theta,<span class="keywordtype">double</span> siep_params[]){
<a name="l00091"></a>00091 <span class="keywordflow">return</span> 0.0;
<a name="l00092"></a>00092 }
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 
<a name="l00109"></a>00109 
<a name="l00118"></a><a class="code" href="siep__curves_8h.html#4cac1f8fd8413fddfa9418fa4a739891">00118</a> <span class="keywordtype">void</span> <a class="code" href="siep__curves_8h.html#4cac1f8fd8413fddfa9418fa4a739891">cc_tan_siep</a>(<span class="keywordtype">double</span> siep_params[],<span class="keywordtype">double</span> xtcc[], <span class="keywordtype">double</span> ytcc[], <span class="keywordtype">int</span> npts=1000,  FILE *file_in1=NULL){
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 <span class="keywordtype">double</span> theta = 0.0, theta_e=0.0;
<a name="l00121"></a>00121 <span class="keywordtype">double</span> x1_cct[npts],x2_cct[npts];
<a name="l00122"></a>00122 <span class="keywordtype">double</span> y1_cct[npts],y2_cct[npts];
<a name="l00123"></a>00123 <span class="keywordtype">int</span> pflag=siep_params[0];
<a name="l00124"></a>00124 <span class="keywordtype">double</span> elp=siep_params[1];
<a name="l00125"></a>00125 <span class="keywordtype">double</span> b=siep_params[2];
<a name="l00126"></a>00126 <span class="keywordtype">double</span> a1e,a2e;
<a name="l00127"></a>00127 <span class="keywordflow">if</span>(pflag==1){a1e=1.-elp;a2e=1.+elp;}
<a name="l00128"></a>00128 <span class="keywordflow">if</span>(pflag==2){a1e=1.; a2e=1./pow(1.-elp,2);}
<a name="l00129"></a>00129 
<a name="l00130"></a>00130 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;npts;i++){
<a name="l00131"></a>00131 
<a name="l00132"></a>00132   theta_e=atan(sqrt(a2e/a1e)*tan(theta));  
<a name="l00133"></a>00133 
<a name="l00134"></a>00134   x1_cct[i]=<a class="code" href="siep__curves_8h.html#a79848608dfc953b540938a39c4def10">r_cct_siep</a>(theta,siep_params)*cos(theta_e)/sqrt(a1e);
<a name="l00135"></a>00135   x2_cct[i]=<a class="code" href="siep__curves_8h.html#a79848608dfc953b540938a39c4def10">r_cct_siep</a>(theta,siep_params)*sin(theta_e)/sqrt(a2e);
<a name="l00136"></a>00136   xtcc[i]=x1_cct[i];
<a name="l00137"></a>00137   ytcc[i]=x2_cct[i];
<a name="l00138"></a>00138 
<a name="l00139"></a>00139   y1_cct[i]= fabs(<a class="code" href="siep__lens__funct_8h.html#81bc3f8e6b5353cacf451aa58bb368a1">y1_siep</a>(x1_cct[i]/b, x2_cct[i]/b,siep_params));  
<a name="l00140"></a>00140   y2_cct[i]= fabs(<a class="code" href="siep__lens__funct_8h.html#bf20df72b8c0003e9e70e3b7be133d09">y2_siep</a>(x1_cct[i]/b, x2_cct[i]/b,siep_params)); 
<a name="l00141"></a>00141 
<a name="l00142"></a>00142   <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00143"></a>00143       printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>,x1_cct[i]*b, x2_cct[i]*b,y1_cct[i]*b, y2_cct[i]*b);
<a name="l00144"></a>00144    } <span class="keywordflow">else</span> {
<a name="l00145"></a>00145      fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, x1_cct[i]*b, x2_cct[i]*b,y1_cct[i]*b, y2_cct[i]*b);}
<a name="l00146"></a>00146       
<a name="l00147"></a>00147    theta+= PI/(2.*npts); 
<a name="l00148"></a>00148 }
<a name="l00149"></a>00149 <span class="comment">// writting in the second quadrant</span>
<a name="l00150"></a>00150 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=npts-1;i&gt;0;i--){
<a name="l00151"></a>00151      <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00152"></a>00152       printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>,-x1_cct[i]*b, x2_cct[i]*b,-y1_cct[i]*b, y2_cct[i]*b);
<a name="l00153"></a>00153    } <span class="keywordflow">else</span> {
<a name="l00154"></a>00154     fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, -x1_cct[i]*b, x2_cct[i]*b,-y1_cct[i]*b, y2_cct[i]*b);}
<a name="l00155"></a>00155 }
<a name="l00156"></a>00156 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;npts; i++){
<a name="l00157"></a>00157     <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00158"></a>00158       printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>,-x1_cct[i]*b, -x2_cct[i]*b, -y1_cct[i]*b, -y2_cct[i]*b);
<a name="l00159"></a>00159    } <span class="keywordflow">else</span> {
<a name="l00160"></a>00160     fprintf(file_in1,<span class="stringliteral">" %lg %lg %lg %lg \n"</span>, -x1_cct[i]*b, -x2_cct[i]*b, -y1_cct[i]*b, -y2_cct[i]*b);}
<a name="l00161"></a>00161     
<a name="l00162"></a>00162 }
<a name="l00163"></a>00163 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=npts-1;i&gt;0;i--){
<a name="l00164"></a>00164     <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00165"></a>00165       printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>,x1_cct[i]/b, -x2_cct[i]/b,y1_cct[i]/b, -y2_cct[i]/b);
<a name="l00166"></a>00166    } <span class="keywordflow">else</span> {
<a name="l00167"></a>00167     fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, x1_cct[i]*b, -x2_cct[i]*b, y1_cct[i]*b, -y2_cct[i]*b);}
<a name="l00168"></a>00168 }
<a name="l00169"></a>00169 
<a name="l00170"></a>00170 }
<a name="l00171"></a>00171 
<a name="l00186"></a>00186 
<a name="l00194"></a><a class="code" href="siep__curves_8h.html#015abea7a25a6a6bb5ba34b9733f6231">00194</a> <span class="keywordtype">void</span> <a class="code" href="siep__curves_8h.html#015abea7a25a6a6bb5ba34b9733f6231">cc_lw_pos_siep</a>(<span class="keywordtype">double</span> siep_params[], <span class="keywordtype">double</span> lw_th, <span class="keywordtype">double</span> xlwp[], <span class="keywordtype">double</span> ylwp[], <span class="keywordtype">int</span> npts=1000, FILE *file_in1=NULL){
<a name="l00195"></a>00195 
<a name="l00196"></a>00196 <span class="keywordtype">double</span> theta = 0.0, theta_e=0.0;
<a name="l00197"></a>00197 <span class="keywordtype">double</span> x1_cct[npts],x2_cct[npts];
<a name="l00198"></a>00198 <span class="keywordtype">double</span> y1_cct[npts],y2_cct[npts];
<a name="l00199"></a>00199 <span class="keywordtype">int</span> pflag=siep_params[0];
<a name="l00200"></a>00200 <span class="keywordtype">double</span> elp=siep_params[1];
<a name="l00201"></a>00201 <span class="keywordtype">double</span> b=siep_params[2];
<a name="l00202"></a>00202 <span class="keywordtype">double</span> a1e,a2e;
<a name="l00203"></a>00203 <span class="keywordflow">if</span>(pflag==1){a1e=1.-elp;a2e=1.+elp;}
<a name="l00204"></a>00204 <span class="keywordflow">if</span>(pflag==2){a1e=1.; a2e=1./pow(1.-elp,2);}
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 
<a name="l00207"></a>00207 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;npts;i++){
<a name="l00208"></a>00208 
<a name="l00209"></a>00209   theta_e=atan(sqrt(a2e/a1e)*tan(theta));  
<a name="l00210"></a>00210 
<a name="l00211"></a>00211   x1_cct[i]=<a class="code" href="siep__curves_8h.html#db35e2654637d89bc9ba30a21fd959d0">r_th_siep</a>(theta,siep_params,lw_th)*cos(theta_e)/sqrt(a1e);
<a name="l00212"></a>00212   x2_cct[i]=<a class="code" href="siep__curves_8h.html#db35e2654637d89bc9ba30a21fd959d0">r_th_siep</a>(theta,siep_params,lw_th)*sin(theta_e)/sqrt(a2e);
<a name="l00213"></a>00213   xlwp[i]=x1_cct[i], ylwp[i]=x2_cct[i];
<a name="l00214"></a>00214 
<a name="l00215"></a>00215   y1_cct[i]= fabs(<a class="code" href="siep__lens__funct_8h.html#81bc3f8e6b5353cacf451aa58bb368a1">y1_siep</a>(x1_cct[i]/b, x2_cct[i]/b,siep_params));  
<a name="l00216"></a>00216   y2_cct[i]= fabs(<a class="code" href="siep__lens__funct_8h.html#bf20df72b8c0003e9e70e3b7be133d09">y2_siep</a>(x1_cct[i]/b, x2_cct[i]/b,siep_params)); 
<a name="l00217"></a>00217 
<a name="l00218"></a>00218   <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00219"></a>00219       printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>,x1_cct[i]*b, x2_cct[i]*b, y1_cct[i]*b, y2_cct[i]*b);
<a name="l00220"></a>00220    } <span class="keywordflow">else</span> {
<a name="l00221"></a>00221      fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, x1_cct[i]*b, x2_cct[i]*b,y1_cct[i]*b, y2_cct[i]*b);}
<a name="l00222"></a>00222       
<a name="l00223"></a>00223    theta+= PI/(2.*npts); 
<a name="l00224"></a>00224 }
<a name="l00225"></a>00225 <span class="comment">// writting in the second quadrant</span>
<a name="l00226"></a>00226 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=npts-1;i&gt;0;i--){
<a name="l00227"></a>00227     <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00228"></a>00228       printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, -x1_cct[i]*b, x2_cct[i]*b, -y1_cct[i]*b, y2_cct[i]*b);
<a name="l00229"></a>00229    } <span class="keywordflow">else</span> {
<a name="l00230"></a>00230     fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, -x1_cct[i]*b, x2_cct[i]*b, -y1_cct[i]*b, y2_cct[i]*b);}
<a name="l00231"></a>00231 }
<a name="l00232"></a>00232 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;npts; i++){
<a name="l00233"></a>00233     <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00234"></a>00234       printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, -x1_cct[i]*b, -x2_cct[i]*b, -y1_cct[i]*b, -y2_cct[i]*b);
<a name="l00235"></a>00235    } <span class="keywordflow">else</span> {
<a name="l00236"></a>00236     fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, -x1_cct[i]*b, -x2_cct[i]*b, -y1_cct[i]*b, -y2_cct[i]*b);}
<a name="l00237"></a>00237 }
<a name="l00238"></a>00238 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=npts-1;i&gt;0;i--){
<a name="l00239"></a>00239     <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00240"></a>00240       printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, x1_cct[i]*b, -x2_cct[i]*b, y1_cct[i]*b, -y2_cct[i]*b);
<a name="l00241"></a>00241    } <span class="keywordflow">else</span> {
<a name="l00242"></a>00242     fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, x1_cct[i]*b, -x2_cct[i]*b, y1_cct[i]*b, -y2_cct[i]*b);}
<a name="l00243"></a>00243 }
<a name="l00244"></a>00244 
<a name="l00245"></a>00245 }
<a name="l00260"></a>00260 
<a name="l00268"></a><a class="code" href="siep__curves_8h.html#bb975e8f3f17a3a66378d5c5cc3fb33b">00268</a> <span class="keywordtype">void</span> <a class="code" href="siep__curves_8h.html#bb975e8f3f17a3a66378d5c5cc3fb33b">cc_lw_neg_siep</a>(<span class="keywordtype">double</span> siep_params[], <span class="keywordtype">double</span> lw_th, <span class="keywordtype">double</span> xlwn[], <span class="keywordtype">double</span> ylwn[], <span class="keywordtype">int</span> npts=1000, FILE *file_in1=NULL){
<a name="l00269"></a>00269 <span class="comment">//</span>
<a name="l00270"></a>00270 <span class="keywordtype">double</span> theta = 0.0, theta_e=0.0;
<a name="l00271"></a>00271 <span class="keywordtype">double</span> x1_cct[npts],x2_cct[npts];
<a name="l00272"></a>00272 <span class="keywordtype">double</span> y1_cct[npts],y2_cct[npts];
<a name="l00273"></a>00273 <span class="keywordtype">int</span> pflag=siep_params[0];
<a name="l00274"></a>00274 <span class="keywordtype">double</span> elp=siep_params[1];
<a name="l00275"></a>00275 <span class="keywordtype">double</span> b=siep_params[2];
<a name="l00276"></a>00276 <span class="keywordtype">double</span> a1e,a2e;
<a name="l00277"></a>00277 <span class="keywordflow">if</span>(pflag==1){a1e=1.-elp;a2e=1.+elp;}
<a name="l00278"></a>00278 <span class="keywordflow">if</span>(pflag==2){a1e=1.; a2e=1./pow(1.-elp,2);}
<a name="l00279"></a>00279 
<a name="l00280"></a>00280 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;npts;i++){
<a name="l00281"></a>00281 
<a name="l00282"></a>00282   theta_e=atan(sqrt(a2e/a1e)*tan(theta));  
<a name="l00283"></a>00283 
<a name="l00284"></a>00284   x1_cct[i]=<a class="code" href="siep__curves_8h.html#db35e2654637d89bc9ba30a21fd959d0">r_th_siep</a>(theta,siep_params,-lw_th)*cos(theta_e)/sqrt(a1e);
<a name="l00285"></a>00285   x2_cct[i]=<a class="code" href="siep__curves_8h.html#db35e2654637d89bc9ba30a21fd959d0">r_th_siep</a>(theta,siep_params,-lw_th)*sin(theta_e)/sqrt(a2e);
<a name="l00286"></a>00286   xlwn[i]=x1_cct[i], ylwn[i]=x2_cct[i];
<a name="l00287"></a>00287 
<a name="l00288"></a>00288   y1_cct[i]= fabs(<a class="code" href="siep__lens__funct_8h.html#81bc3f8e6b5353cacf451aa58bb368a1">y1_siep</a>(x1_cct[i]/b, x2_cct[i]/b,siep_params));  
<a name="l00289"></a>00289   y2_cct[i]= fabs(<a class="code" href="siep__lens__funct_8h.html#bf20df72b8c0003e9e70e3b7be133d09">y2_siep</a>(x1_cct[i]/b, x2_cct[i]/b,siep_params)); 
<a name="l00290"></a>00290 
<a name="l00291"></a>00291   <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00292"></a>00292       printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>,x1_cct[i]*b, x2_cct[i]*b, y1_cct[i]*b, y2_cct[i]*b);
<a name="l00293"></a>00293    } <span class="keywordflow">else</span> {
<a name="l00294"></a>00294      fprintf(file_in1,<span class="stringliteral">" %lg %lg %lg %lg \n"</span>, x1_cct[i]*b, x2_cct[i]*b, y1_cct[i]*b, y2_cct[i]*b);}
<a name="l00295"></a>00295       
<a name="l00296"></a>00296    theta+= PI/(2.*npts); 
<a name="l00297"></a>00297 }
<a name="l00298"></a>00298 <span class="comment">// writting in the second quadrant</span>
<a name="l00299"></a>00299 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=npts-1;i&gt;0;i--){
<a name="l00300"></a>00300     <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00301"></a>00301       printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>,-x1_cct[i]*b, x2_cct[i]*b,-y1_cct[i]*b, y2_cct[i]*b);
<a name="l00302"></a>00302    } <span class="keywordflow">else</span> {
<a name="l00303"></a>00303     fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg  \n"</span>, -x1_cct[i]*b, x2_cct[i]*b,-y1_cct[i]*b, y2_cct[i]*b);}
<a name="l00304"></a>00304 }
<a name="l00305"></a>00305 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;npts; i++){
<a name="l00306"></a>00306    <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00307"></a>00307    printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>,-x1_cct[i]*b, -x2_cct[i]*b, -y1_cct[i]*b, -y2_cct[i]*b);
<a name="l00308"></a>00308    } <span class="keywordflow">else</span> {
<a name="l00309"></a>00309     fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, -x1_cct[i]*b, -x2_cct[i]*b, -y1_cct[i]*b, -y2_cct[i]*b);}
<a name="l00310"></a>00310 }
<a name="l00311"></a>00311 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=npts-1;i&gt;0;i--){
<a name="l00312"></a>00312     <span class="keywordflow">if</span>(file_in1==NULL){printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>,x1_cct[i]*b, -x2_cct[i]*b,y1_cct[i]*b, -y2_cct[i]*b);
<a name="l00313"></a>00313    } <span class="keywordflow">else</span> {fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, x1_cct[i]*b, -x2_cct[i]*b,y1_cct[i]*b, -y2_cct[i]*b);}
<a name="l00314"></a>00314 }
<a name="l00315"></a>00315 
<a name="l00316"></a>00316 }
<a name="l00331"></a>00331 
<a name="l00340"></a><a class="code" href="siep__curves_8h.html#b6f9bf17f6a43ce12a3850c5f7fcb11c">00340</a> <span class="keywordtype">void</span> <a class="code" href="siep__curves_8h.html#b6f9bf17f6a43ce12a3850c5f7fcb11c">cc_rad_siep</a>(<span class="keywordtype">double</span> siep_params[], <span class="keywordtype">double</span> xrad[], <span class="keywordtype">double</span> yrad[], <span class="keywordtype">int</span> npts=1000, FILE *file_in1=NULL){
<a name="l00341"></a>00341 
<a name="l00342"></a>00342 <span class="keywordtype">double</span> theta = 0.0, theta_e=0.0;
<a name="l00343"></a>00343 <span class="keywordtype">double</span> x1_ccr[npts],x2_ccr[npts];
<a name="l00344"></a>00344 <span class="keywordtype">double</span> y1_ccr[npts],y2_ccr[npts];
<a name="l00345"></a>00345 <span class="keywordtype">int</span> pflag=siep_params[0];
<a name="l00346"></a>00346 <span class="keywordtype">double</span> elp=siep_params[1];
<a name="l00347"></a>00347 <span class="keywordtype">double</span> b=siep_params[2];
<a name="l00348"></a>00348 <span class="keywordtype">double</span> a1e,a2e;
<a name="l00349"></a>00349 <span class="keywordflow">if</span>(pflag==1){a1e=1.-elp;a2e=1.+elp;}
<a name="l00350"></a>00350 <span class="keywordflow">if</span>(pflag==2){a1e=1.; a2e=1./pow(1.-elp,2);}
<a name="l00351"></a>00351 
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;npts;i++){
<a name="l00354"></a>00354 
<a name="l00355"></a>00355   theta_e=atan(sqrt(a2e/a1e)*tan(theta));  
<a name="l00356"></a>00356 
<a name="l00357"></a>00357   x1_ccr[i]=<a class="code" href="siep__curves_8h.html#de539e48ff3f732df64e64bfcc216373">r_ccr_siep</a>(theta,siep_params)*cos(theta_e)/sqrt(a1e);
<a name="l00358"></a>00358   x2_ccr[i]=<a class="code" href="siep__curves_8h.html#de539e48ff3f732df64e64bfcc216373">r_ccr_siep</a>(theta,siep_params)*sin(theta_e)/sqrt(a2e);
<a name="l00359"></a>00359   xrad[i]=x1_ccr[i],yrad[i]=x2_ccr[i];
<a name="l00360"></a>00360 
<a name="l00361"></a>00361   y1_ccr[i]= fabs(x1_ccr[i]/b-sqrt(a1e)*cos(theta_e));  
<a name="l00362"></a>00362   y2_ccr[i]= fabs(x2_ccr[i]/b-sqrt(a2e)*sin(theta_e)); 
<a name="l00363"></a>00363 
<a name="l00364"></a>00364 
<a name="l00365"></a>00365   <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00366"></a>00366     printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>,x1_ccr[i]*b, x2_ccr[i]*b, y1_ccr[i]*b, y2_ccr[i]*b);
<a name="l00367"></a>00367    } <span class="keywordflow">else</span> {
<a name="l00368"></a>00368   fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, x1_ccr[i]*b, x2_ccr[i]*b, y1_ccr[i]*b, y2_ccr[i]*b);}
<a name="l00369"></a>00369       
<a name="l00370"></a>00370    theta+= PI/(2.*npts); 
<a name="l00371"></a>00371 }
<a name="l00372"></a>00372 <span class="comment">// writting in the second quadrant</span>
<a name="l00373"></a>00373 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=npts-1;i&gt;=0;i--){
<a name="l00374"></a>00374     <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00375"></a>00375     printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, -x1_ccr[i]*b, x2_ccr[i]*b, -y1_ccr[i]*b, y2_ccr[i]*b);
<a name="l00376"></a>00376    } <span class="keywordflow">else</span> {
<a name="l00377"></a>00377     fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, -x1_ccr[i]*b, x2_ccr[i]*b, -y1_ccr[i]*b, y2_ccr[i]*b);}
<a name="l00378"></a>00378 }
<a name="l00379"></a>00379 <span class="comment">//writting in the third quadrant</span>
<a name="l00380"></a>00380 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;npts; i++){
<a name="l00381"></a>00381     <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00382"></a>00382     printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>,-x1_ccr[i]*b, -x2_ccr[i]*b, -y1_ccr[i]*b, -y2_ccr[i]*b);
<a name="l00383"></a>00383    } <span class="keywordflow">else</span> {
<a name="l00384"></a>00384     fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, -x1_ccr[i]*b, -x2_ccr[i]*b, -y1_ccr[i]*b, -y2_ccr[i]*b);}
<a name="l00385"></a>00385 }
<a name="l00386"></a>00386 <span class="comment">//writting in the fourth quadrant</span>
<a name="l00387"></a>00387 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=npts-1;i&gt;=0;i--){
<a name="l00388"></a>00388     <span class="keywordflow">if</span>(file_in1==NULL){
<a name="l00389"></a>00389     printf(<span class="stringliteral">"%lg %lg %lg %lg \n"</span>,x1_ccr[i]*b, -x2_ccr[i]*b, y1_ccr[i]*b, -y2_ccr[i]*b);
<a name="l00390"></a>00390    } <span class="keywordflow">else</span> {
<a name="l00391"></a>00391     fprintf(file_in1,<span class="stringliteral">"%lg %lg %lg %lg \n"</span>, x1_ccr[i]*b, -x2_ccr[i]*b, y1_ccr[i]*b, -y2_ccr[i]*b);}
<a name="l00392"></a>00392 
<a name="l00393"></a>00393 }
<a name="l00394"></a>00394 }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396 <span class="keywordtype">double</span> cross_section_siep(<span class="keywordtype">double</span> siep_params[], <span class="keywordtype">double</span> lw_ratio, <span class="keywordtype">int</span> npts=1000){
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 
<a name="l00399"></a>00399 <span class="keywordflow">return</span> 0.0;
<a name="l00400"></a>00400 }
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Feb 16 10:23:26 2011 for SIEP by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
